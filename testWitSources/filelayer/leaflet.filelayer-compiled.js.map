{"version":3,"sources":["leaflet.filelayer.js"],"names":[],"mappings":"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","file":"leaflet.filelayer-compiled.js","sourcesContent":["/*\r\n * Load files *locally* (GeoJSON, KML, GPX) into the map\r\n * using the HTML5 File API.\r\n *\r\n * Requires Pavel Shramov's GPX.js\r\n * https://github.com/shramov/leaflet-plugins/blob/d74d67/layer/vector/GPX.js\r\n *\r\n * Requires Pavel mholt papaparse.js\r\n * https://github.com/mholt/PapaParse/blob/master/papaparse.js\r\n *\r\n * Requires gildas-lormeau zip.js and mbostock d3.js only if you want to try to load zip archive of GTFS .\r\n * https://gildas-lormeau.github.io/zip.js/ , https://github.com/mbostock/d3\r\n *\r\n *\r\n * //TODO try to avoid the use of papaparse in favor of d3\r\n * //TODO upgrade the gtfs zip draw on the map work oly if the 'shapes' file is present\r\n */\r\nvar FileLoader = L.Class.extend({\r\n    includes: L.Mixin.Events,\r\n    options: {\r\n        layerOptions: {},\r\n        fileSizeLimit: 1024,\r\n        headers: true,             //if the first line of a csv file has headers (if false launch exception)\r\n\t\tlatitudeColumn: 'lat',     //the default field name for the latitude coordinates...\r\n\t\tlongitudeColumn: 'lng',    //the default field name for the longitude coordinates...\r\n        titleForSearch: 'title',   //for future integration with other functions...\r\n        titlesToInspect: [],       //if you want get only some specific field from csv files...\r\n                                   //TODO implement for XML files....\r\n        rootTag: {root: \"Root\", subRoot:\"Row\"},  //set the Json path to the collection of json object to inspect...\r\n                                                 //you can many subRoot e.g. '...,subRoot2:xxx,subRoot3:yyy'\r\n                                                 //or if you prefer set a Array e.g. [\"Root\",\"Row\"]\r\n\r\n        rdfLink: [],               //if you want merge the json object created from a rdf file you can specify the property of a link...\r\n        rdfAbout: 'rdf:about',     //the value for the property rdf:about of a rdf file...\r\n        rdfAboutLink: 'rdf:about', //the value for the property rdf:about for linking different classes of triple...\r\n\r\n        layer: new L.geoJson(),    //make the variable of the layer reachable from external function,\r\n                                   // can be a L.layerGroup or a L.Feautregroup or another L.GeoJson....\r\n        popupTable:false,          //if true all the information of the popup are pushed on a html table for a better view.\r\n                                   //if false is saved on a json object.\r\n        validateGeoJson: false     //if you want to validate the geojson with a ajax call...\r\n    },\r\n\r\n    initialize: function (map, options) {\r\n        this._map = map;\r\n        L.Util.setOptions(this, options);\r\n\r\n        this._parsers = {\r\n            'json': this._loadGeoJSON,\r\n            'geojson': this._loadGeoJSON,\r\n            'gpx': this._convertToGeoJSON,\r\n            'kml': this._convertToGeoJSON,\r\n            'csv': this._csvToGeoJSON,\r\n            'xml': this._XMLToGeoJSON,\r\n            'rdf': this._RDFToGeoJSON,\r\n            'input': this._gtfsToGeoJSON //TODO to upgrade\r\n        };\r\n    },\r\n\r\n    load: function (file /* File */) {\r\n\r\n        // Check file size\r\n        var fileSize;\r\n        if(typeof file == 'undefined') fileSize = 1024; //avoid a console error\r\n        else fileSize = (file.size / 1024).toFixed(4);\r\n\r\n        if (fileSize > this.options.fileSizeLimit) {\r\n            this.fire('data:error', {\r\n                error: new Error('File size exceeds limit (' + fileSize + ' > ' + this.options.fileSizeLimit + 'kb)')\r\n            });\r\n            return;\r\n        }\r\n\r\n        // Check file extension\r\n        var ext = file.name.split('.').pop();\r\n        var parser = this._parsers[ext];\r\n        //Check if file is a document or a archive\r\n        if(ext  == \"zip\"){  //if is a archive\r\n            try {\r\n                this.fire('data:loading', {filename: file.name, format: ext});\r\n                this.fire('data:loaded', {filename: file.name, format: ext});\r\n            }\r\n            catch (err) {\r\n                this.fire('data:error', {error: err});\r\n            }\r\n            return this._gtfsZipToGEOJSON(file);\r\n        }else{\r\n            if (!parser) {  //if is a document\r\n                this.fire('data:error', {\r\n                    error: new Error('Unsupported file type ' + file.type + '(' + ext + ')')\r\n                });\r\n                return;\r\n            }\r\n            // Read selected file using HTML5 File API\r\n            var reader = new FileReader();\r\n            reader.onload = L.Util.bind(function (e) {\r\n                try {\r\n                    this.fire('data:loading', {filename: file.name, format: ext});\r\n                    var layer = parser.call(this, e.target.result, ext);\r\n                    this.fire('data:loaded', {layer: layer, filename: file.name, format: ext});\r\n                }\r\n                catch (err) {\r\n                    this.fire('data:error', {error: err});\r\n                }\r\n            }, this);\r\n            reader.readAsText(file);\r\n            return reader; //return the document\r\n        }\r\n    },\r\n\r\n    _loadGeoJSON: function (content) {\r\n        if (typeof content == 'string') {\r\n            content = JSON.parse(content);\r\n        }\r\n\r\n        var layer = this.options.layer;\r\n        if (layer.getLayers().length > 0) {\r\n            //there are other information to merge to the result....\r\n            layer.addLayer(new L.geoJson(content, this.options.layerOptions));\r\n\r\n        } else {\r\n            //console.error(\"load json:\"+JSON.stringify(content,undefined,2));\r\n            try {\r\n                layer = L.geoJson(content, this.options.layerOptions);\r\n            }catch(e){ console.error(e.message);}\r\n        }\r\n        if (layer.getLayers().length === 0) {\r\n            this.fire('data:error', {\r\n                error: new Error('GeoJSON has no valid layers.\\n' +\r\n                    'if you try to load a CSV/RDF/XML file make sure to have setted the corrected name of the columns')\r\n            });\r\n        }\r\n        if (this.options.addToMap) {\r\n            layer.addTo(this._map);\r\n            //map.addLayer(layer);\r\n        }\r\n        return  layer;\r\n    },\r\n\r\n    _convertToGeoJSON: function (content, format) {\r\n        // Format is either 'gpx' or 'kml'\r\n        if (typeof content == 'string') {\r\n            content = ( new window.DOMParser() ).parseFromString(content, \"text/xml\");\r\n        }\r\n        var geojson = toGeoJSON[format](content);\r\n        return this._loadGeoJSON(geojson);\r\n    },\r\n\r\n    _csvToGeoJSON: function(content){\r\n        try {\r\n            if (!this.options.headers) {\r\n                this.fire('data:error', {error: new Error('The file CSV must have the Headers')});\r\n            }\r\n            var json;\r\n            //Work with Papaparse.js\r\n            json = Papa.parse(content, {header: this.options.headers});\r\n            this._depth = json.data.length - 1;\r\n            if (this.options.titlesToInspect.length == 0)this._titles = json.meta.fields;\r\n            else this._titles = this.options.titlesToInspect;\r\n            delete json.errors;\r\n            delete json.meta;\r\n\r\n            json = this._addFeatureToJson(json.data);\r\n            return this._loadGeoJSON(json);\r\n        }catch(e){\r\n            console.error(e.message);\r\n            this.fire('data:error', {error: e});\r\n        }\r\n    },\r\n\r\n    _keyCount:function(o){\r\n        return (typeof o == 'object') ? Object.keys(o).length : 0;\r\n    },\r\n\r\n    _addFeatureToJson: function(json){\r\n        //be sure we have a json array of object of objects\r\n        if(json === null || typeof json === 'undefined' || Object.keys(json).length==0){\r\n            console.error(\"Be sure to add the feature geojson to a Array or a Object of objects.\");\r\n            return;\r\n        }\r\n        var titles = this._titles;\r\n        var columnLat =this.options.latitudeColumn;\r\n        var columnLng = this.options.longitudeColumn;\r\n        var popupTable = this.options.popupTable;\r\n        json = {\r\n            type: \"FeatureCollection\",\r\n            features: Object.keys(json).map(function (id) {\r\n                //id 0,1,2,3,4,5,.....\r\n                var obj = json[id];\r\n                if (obj === null || typeof obj === 'undefined' || id >= Object.keys(json).length - 1) {\r\n                    console.warn(\"Ignore line \", id, \" invalid data\");\r\n                    return;\r\n                } else {\r\n                    //if you not have setted a specific set of columns just get everything\r\n                    if (!titles.length > 0)titles = Object.keys(obj);\r\n\r\n                    return {\r\n                        type: 'Feature',\r\n                        properties: {\r\n                            id: id,\r\n                            //integration for search\r\n                            title: (function () {\r\n                                for (var search, i = 0; search = titles[i++];) {\r\n                                    if (titles[i] == search)  return obj[search];\r\n                                }\r\n                                return id;\r\n                            })(),\r\n                            popupContent: (function () {\r\n                                var content = '';\r\n                                if (popupTable) {\r\n                                    content = '<div class=\"popup-content\">' +\r\n                                        '<table class=\"table table-striped table-bordered table-condensed\">';\r\n                                }\r\n                                for (var title, i = 0; title = titles[i++];) {\r\n                                    try {\r\n                                        if(obj.hasOwnProperty(title)) {\r\n                                            if (popupTable) {\r\n                                                var href = '';\r\n                                                if (obj[title].indexOf('http') === 0) {\r\n                                                    href = '<a target=\"_blank\" href=\"' + obj[title] + '\">' + obj[title] + '</a>';\r\n                                                }\r\n                                                if (href.length > 0)content += '<tr><th>' + title + '</th><td>' + href + '</td></tr>';\r\n                                                else content += '<tr><th>' + title + '</th><td>' + obj[title] + '</td></tr>';\r\n                                            } else {\r\n                                                content[title] = obj[title];\r\n                                            }\r\n                                        }\r\n                                    } catch (e) {\r\n                                        console.warn(\r\n                                            \"Undefined field for the json:\"\r\n                                            +JSON.stringify(obj)+\",Title:\"+title+\"->\"+e.message);\r\n                                    }\r\n                                }//for\r\n                                if (popupTable)content += \"</table></div>\";\r\n                                return content;\r\n                            })()\r\n                        },\r\n                        geometry: {\r\n                            type: \"Point\",\r\n                            coordinates: (function () {\r\n                                //check now only the feature with correct coordinate\r\n                                var lng = obj[columnLng].toString();\r\n                                var lat = obj[columnLat].toString();\r\n                                try {\r\n                                    if (/[a-z]/.test(lng.toLowerCase()) || /[a-z]/.test(lat.toLowerCase()) ||\r\n                                        isNaN(lng) || isNaN(lat) || !isFinite(lng) || !isFinite(lat)) {\r\n                                        console.warn(\"Coords lnglat:[\" + lng + \",\" + lat + \"] ,id:\" + id);\r\n                                        return;\r\n                                    }else{\r\n                                        lng = parseFloat(obj[columnLng]);\r\n                                        lat = parseFloat(obj[columnLat]);\r\n                                        if (!(lng < 180 && lng > -180 && lat < 90 && lat > -90)) {\r\n                                            console.warn(\"Something wrong with the coordinates, ignore line\", id, \" invalid data\");\r\n                                            return;\r\n                                        }\r\n                                    }\r\n                                } catch (e) {\r\n                                    //try with the string\r\n                                    console.warn(\"Not valid coordinates avoid this line ->\" + \"Coords:\" + lng + \",\" + lat + \",id:\" + id);\r\n                                    return;\r\n                                }\r\n                                return [lng, lat];\r\n                            })()\r\n                        }\r\n                    };\r\n                }//if obj is not null\r\n            })\r\n        };\r\n        this._cleanJson(json);\r\n        if(this.options.validateGeoJson) {\r\n            ajax._validateGeoJson(json, function (message) {\r\n                ajax.processSuccess(message);\r\n            });\r\n            if (ajax.result.isCorrect)return json;\r\n            else console.error(\"The geo json generated is wrong:\" + JSON.stringify(ajax.result.response, undefined, 2));\r\n        }else return json;\r\n    },\r\n\r\n    _RDFToGeoJSON: function(content) {\r\n        try {\r\n            var xml = this._toXML(content);\r\n            var json = this._XMLToJSON(xml);\r\n\r\n            for (var i = 0; i < Object.keys(this.options.rootTag).length; i++) {\r\n                json = json[this.options.rootTag[Object.keys(this.options.rootTag)[i]]];\r\n            }\r\n\r\n            this._simplifyJson(json);\r\n            this._mergeRdfJson(this._root.data);\r\n            //Filter result, get all object with at least coordinates...\r\n            for (i = 0; i < this._root.data.length; i++) {\r\n                if (!(this._root.data[i].hasOwnProperty(this.options.latitudeColumn) &&\r\n                    this._root.data[i].hasOwnProperty(this.options.longitudeColumn))\r\n                ) {\r\n                    delete this._root.data[i];\r\n                }\r\n            }\r\n            this._depth = this._root.data.length;\r\n            json = this._addFeatureToJson(this._root.data);\r\n\r\n            return this._loadGeoJSON(json);\r\n        }catch(e){console.error(e.message);}\r\n    },\r\n\r\n    _toXML:function(content){\r\n        var xml;\r\n        try {\r\n            if(window.DOMParser){\r\n                xml = new DOMParser().parseFromString(content,\"text/xml\");\r\n            }\r\n            else{\r\n                try {\r\n                    xml = new ActiveXObject(\"Microsoft.XMLDOM\");\r\n                    xml.async = false;\r\n                    xml.validateOnParse = false;\r\n                    xml.resolveExternals = false;\r\n                    xml.loadXML(content);\r\n                } catch (e) {\r\n                    try {\r\n                        Document.prototype.loadXML = function (s) {\r\n                            var doc2 = (new DOMParser()).parseFromString(s, \"text/xml\");\r\n                            while (this.hasChildNodes()) {\r\n                                this.removeChild(this.lastChild);\r\n                            }\r\n                            for (var i = 0; i < doc2.childNodes.length; i++) {\r\n                                this.appendChild(this.importNode(doc2.childNodes[i], true));\r\n                            }\r\n                        };\r\n                        xml = document.implementation.createDocument('', '', null);\r\n                        xml.loadXML(content);\r\n                    } catch (e) {\r\n                        this.fire('data:error', {error: new Error(e.message)});\r\n                    }\r\n                }\r\n            }\r\n        }catch(e) {\r\n            throw new Error(e.message);\r\n        }\r\n        return xml;\r\n    },\r\n\r\n    _XMLToJSON:function (content) {\r\n        var attr,\r\n            child,\r\n            attrs = content.attributes,\r\n            children = content.childNodes,\r\n            key = content.nodeType,\r\n            json = {},\r\n            i = -1;\r\n        if (key == 1 && attrs.length) {\r\n            json[key = '@attributes'] = {};\r\n            while (attr = attrs.item(++i)) {\r\n                json[key][attr.nodeName] = attr.nodeValue;\r\n            }\r\n            i = -1;\r\n        } else if (key == 3) {\r\n            json = content.nodeValue;\r\n        }\r\n        while (child = children.item(++i)) {\r\n            key = child.nodeName;\r\n            if (json.hasOwnProperty(key)) {\r\n                if (json.toString.call(json[key]) != '[object Array]') {\r\n                    json[key] = [json[key]];\r\n                }\r\n                json[key].push(this._XMLToJSON(child));\r\n            }\r\n            else {\r\n                json[key] = this._XMLToJSON(child);\r\n            }\r\n        }\r\n        return json;\r\n    },\r\n\r\n    _XMLToGeoJSON: function(content){\r\n        var xml = this._toXML(content);\r\n        var json = this._XMLToJSON(xml);\r\n\r\n        for(var i = 0; i < Object.keys(this.options.rootTag).length; i++){\r\n            json = json[this.options.rootTag[Object.keys(this.options.rootTag)[i]]];\r\n        }\r\n\r\n        this._simplifyJson(json);\r\n\r\n        //Filter result, get all object with at least coordinates...\r\n        for(i = 0; i < this._root.data.length; i++){\r\n            if(!(this._root.data[i].hasOwnProperty(this.options.latitudeColumn) &&\r\n                this._root.data[i].hasOwnProperty(this.options.longitudeColumn))\r\n            ){\r\n                delete this._root.data[i];\r\n            }\r\n        }\r\n\r\n        this._depth = this._root.data.length;\r\n\r\n        json = this._addFeatureToJson(this._root.data);\r\n        return this._loadGeoJSON(json);\r\n    },\r\n\r\n    _simplifyJson: function(json){\r\n        if(!(Object.prototype.toString.call(json) === '[object Array]')){\r\n            this.fire('data:error', {\r\n                error: new Error('Try to simplify a not json array, please re-set your root tag path, ' +\r\n                    'e.g. xmlRootTag:[\"some\",\"pathTo\",\"Array\"], we need a json array')\r\n            });\r\n            return;\r\n        }\r\n        var root = {data: []};\r\n        for (var i = 0; i < Object.keys(json).length; i++) {  //406 object\r\n            var obj;\r\n            if (typeof  json[i] === 'undefined')break; //read all\r\n            else  obj = json[i];\r\n            var info = {};\r\n            try {\r\n                var elements;\r\n                if(Object.keys(obj).length > 1) elements = Object.keys(obj).toString().split(\",\");\r\n                else elements = Object.keys(obj).toString();\r\n                for(var element, k=0; element = elements[k++];){\r\n                //for (var ele in elements) {\r\n                    //var element = elements[ele]; //@attributes\r\n                    var key, value;\r\n                    if (element.toString() == \"#text\") {\r\n                        if (Object.prototype.toString.call(obj[element]) === '[object Array]') {\r\n                            //key = element;\r\n                            //value = obj[element][\"#text\"];\r\n                            continue;\r\n                        }else {\r\n                            key = element;\r\n                            value = obj[element][\"#text\"];\r\n                        }\r\n                    }\r\n                    else if (element.toString() == \"@attributes\") {\r\n                        key = Object.keys(obj[element]);//rdf:\r\n                        value = obj[element][key].toString();\r\n                    }else{\r\n                        key = element;\r\n                        value = Object.keys(obj[element]).toString();\r\n                        if (value == \"@attributes\") {\r\n                            value = obj[element][\"@attributes\"][Object.keys(obj[element][\"@attributes\"])];\r\n                        } else if (value == \"#text\") {\r\n                            value = obj[element][\"#text\"];\r\n                        } else if (value == \"@attributes,#text\") {\r\n                            value = obj[element][\"#text\"];\r\n                            info[key] = value;\r\n                            key = Object.keys(obj[element][\"@attributes\"]);\r\n                            value = obj[element][\"@attributes\"][Object.keys(obj[element][\"@attributes\"])];\r\n                            //info[key] = value;\r\n                        }\r\n                        else {\r\n                            //never run here.....\r\n                            this.fire('data:error', {\r\n                                error: new Error('this stage can\\'t be reach from the simplification of the json \\n' +\r\n                                    'maybe the function need a update')\r\n                            });\r\n                            return;\r\n                        }\r\n                    }\r\n                    info[key] = value;\r\n                }\r\n                root.data.push(info);\r\n            }catch(e){\r\n                console.error(e.message);\r\n                this.fire('data:error', {\r\n                    error: new Error('Some error occurred during the simplification of the Json:'+ e.message+'1\\n')\r\n                });\r\n                return;\r\n            }\r\n           this._root = root;\r\n        }//for every object on rdf description\r\n    },\r\n\r\n    _mergeRdfJson: function(json){\r\n        try {\r\n            var link = '';\r\n            var mJson = [];\r\n            var xJson;\r\n\r\n            for (var i = 0; i < Object.keys(json).length; i++) {\r\n                for (var k = 0; k < Object.keys(this.options.rdfLink).length; k++) {\r\n                    if (json[i].hasOwnProperty(this.options.rdfLink[Object.keys(this.options.rdfLink)[k]])) {\r\n                        link = json[i][this.options.rdfLink[k]];\r\n                        mJson.push(this._searchJsonByKeyAndValue(json, this.options.rdfAboutLink, link));\r\n                    }\r\n                }\r\n            }\r\n            //clean and merge json object with link relations....\r\n            for (i = 0; i < Object.keys(json).length; i++) {\r\n                if (mJson[i] != null && json[i]!=null) {\r\n                     xJson = this._mergeJson(json[i], mJson[i]);\r\n                     json.push(xJson);\r\n                    delete json[json[i]];\r\n                    delete json[mJson[i]];\r\n                }\r\n            }\r\n        }catch(e){\r\n            this.fire('data:error', {\r\n                error: new Error('Some error occurred during the simplification of the Json:'+ e.message)\r\n            });\r\n        }\r\n        this._root.data = json;\r\n    },\r\n\r\n    _searchJsonByKeyAndValue: function(json,key,value){\r\n        for (var i = 0; i < json.length; i++) {\r\n            try {\r\n                if (json[i].hasOwnProperty(key)) {\r\n                    if (json[i][key] == value) {\r\n                        return json[i];\r\n                    }\r\n                }\r\n            }catch(e){\r\n                console.warn(e.message);\r\n            }\r\n        }\r\n    },\r\n\r\n    _mergeJson: function(json1,json2){\r\n        for(var key in json2)\r\n            if(json2.hasOwnProperty(key))\r\n                json1[key] = json2[key];\r\n        return json1;\r\n    },\r\n\r\n    _removeNullJson: function(json){\r\n        // Compact arrays with null entries; delete keys from objects with null value\r\n        var isArray = json instanceof Array;\r\n        for (var k in json){ //type,properties,..,title,popupContent,features,..\r\n            if (json[k]==null || typeof json[k] === 'undefined') isArray ? json.splice(k,1) : delete json[k];\r\n            else if (typeof json[k]==\"object\") this._removeNullJson(json[k]);\r\n        }\r\n    },\r\n\r\n    _cleanJson: function(json){\r\n        this._removeNullJson(json);\r\n        var i = json.features.length;\r\n        while(i--){\r\n            if( typeof json.features[i] === 'undefined' || !json.features[i].geometry.hasOwnProperty(\"coordinates\")){\r\n                json.features.splice(i,1);\r\n            }\r\n        }\r\n    },\r\n\r\n    _gtfsToGeoJSON: function(content){\r\n        var shapes = Papa.parse(content, {header: this.options.headers});\r\n        shapes = shapes.data;\r\n        var lookup = {};\r\n        var dintintShape = [];\r\n        for (var item, i = 0; item = shapes[i++];) {\r\n            var name = item.shape_id;\r\n            if (!(name in lookup)) {\r\n                lookup[name] = 1;\r\n                if(name.length >0)dintintShape.push(name);\r\n            }\r\n        }\r\n        var json = {};\r\n        for(item, i = 0; item = dintintShape[i++];){\r\n            if(item.length >0 && item !='') { //avoid null object\r\n                json[item] = [];\r\n                for (var k = 0; k < Object.keys(shapes).length; k++) {\r\n                    if(shapes[k].shape_id == item)json[item].push(shapes[k]);\r\n                }\r\n            }\r\n        }\r\n        json = {\r\n            type: 'FeatureCollection',\r\n            features: Object.keys(json).map(function (id) {\r\n                return {\r\n                    type: 'Feature',\r\n                    id: id,\r\n                    properties: {\r\n                        shape_id: id\r\n                    },\r\n                    geometry: {\r\n                        type: \"GeometryCollection\",\r\n                        geometries: [\r\n                            {\r\n                                type: \"MultiPoint\",\r\n                                coordinates: (function() {\r\n                                    var coords =[];\r\n                                    for(var s =0; s < Object.keys(json[id]).length; s++){\r\n                                        coords.push([\r\n                                            parseFloat(json[id][s].shape_pt_lon),\r\n                                            parseFloat(json[id][s].shape_pt_lat)\r\n                                        ]);\r\n                                    }\r\n                                    return coords;\r\n                                })()\r\n                            },\r\n                            {\r\n                                type: \"LineString\",\r\n                                coordinates: json[id].sort(function (a, b) {\r\n                                    return +a.shape_pt_sequence - b.shape_pt_sequence;\r\n                                }).map(function (coord) {\r\n                                    return [\r\n                                        parseFloat(coord.shape_pt_lon),\r\n                                        parseFloat(coord.shape_pt_lat)\r\n                                    ];\r\n                                })\r\n                            }\r\n                        ]\r\n                    }\r\n                };\r\n            })\r\n        };\r\n        return this._loadGeoJSON(json);\r\n    },\r\n\r\n    /* ty to kaezarrex () for the code :)*/\r\n    _gtfsZipToGEOJSON: function(file){\r\n        parseGtfs(file, {\r\n            'shapes.txt': load_shapes\r\n            //'stops.txt': load_stops\r\n        });\r\n    },\r\n\r\n\r\n    /*  future integration with ajax call */\r\n    _depth: 0,\r\n    _titles: [],\r\n    _root:{}\r\n\r\n    });\r\n\r\n\r\nL.Control.FileLayerLoad = L.Control.extend({\r\n    statics: {\r\n        TITLE: 'Load local file (GPX, KML, GeoJSON, CSV, RDF, XML)',\r\n        LABEL: '&#8965;'\r\n    },\r\n    options: {\r\n        position: 'topleft',\r\n        fitBounds: true,\r\n        layerOptions: {},\r\n        addToMap: true,\r\n        fileSizeLimit: 1024\r\n    },\r\n\r\n    initialize: function (options) {\r\n        L.Util.setOptions(this, options);\r\n        this.loader = null;\r\n    },\r\n\r\n    onAdd: function (map) {\r\n        this.loader = new FileLoader(map, this.options);\r\n\r\n        this.loader.on('data:loaded', function (e) {\r\n            // Fit bounds after loading\r\n            if (this.options.fitBounds) {\r\n                window.setTimeout(function () {\r\n                    map.fitBounds(e.layer.getBounds());\r\n                }, 500);\r\n            }\r\n        }, this);\r\n\r\n        // Initialize Drag-and-drop\r\n        this._initDragAndDrop(map);\r\n\r\n        // Initialize map control\r\n        return this._initContainer();\r\n    },\r\n\r\n    _initDragAndDrop: function (map) {\r\n        var fileLoader = this.loader,\r\n            dropbox = map._container;\r\n\r\n        var callbacks = {\r\n            dragenter: function () {\r\n                map.scrollWheelZoom.disable();\r\n            },\r\n            dragleave: function () {\r\n                map.scrollWheelZoom.enable();\r\n            },\r\n            dragover: function (e) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n            },\r\n            drop: function (e) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n\r\n                var files = Array.prototype.slice.apply(e.dataTransfer.files),\r\n                    i = files.length;\r\n                setTimeout(function(){\r\n                    fileLoader.load(files.shift());\r\n                    if (files.length > 0) {\r\n                        setTimeout(arguments.callee, 25);\r\n                    }\r\n                }, 25);\r\n                map.scrollWheelZoom.enable();\r\n            }\r\n        };\r\n        for (var name in callbacks)\r\n            dropbox.addEventListener(name, callbacks[name], false);\r\n    },\r\n\r\n    _initContainer: function () {\r\n        // Create a button, and bind click on hidden file input\r\n        var zoomName = 'leaflet-control-filelayer leaflet-control-zoom',\r\n            barName = 'leaflet-bar',\r\n            partName = barName + '-part',\r\n            container = L.DomUtil.create('div', zoomName + ' ' + barName);\r\n        var link = L.DomUtil.create('a', zoomName + '-in ' + partName, container);\r\n        link.innerHTML = L.Control.FileLayerLoad.LABEL;\r\n        link.href = '#';\r\n        link.title = L.Control.FileLayerLoad.TITLE;\r\n\r\n        // Create an invisible file input\r\n        var fileInput = L.DomUtil.create('input', 'hidden', container);\r\n        fileInput.type = 'file';\r\n        if (!this.options.formats) {\r\n            fileInput.accept = '.gpx,.kml,.json,.geojson,.csv,.rdf,.xml,.input,.zip';\r\n        } else {\r\n            fileInput.accept = this.options.formats.join(',');\r\n        }\r\n        fileInput.style.display = 'none';\r\n        // Load on file change\r\n        var fileLoader = this.loader;\r\n        fileInput.addEventListener(\"change\", function (e) {\r\n            fileLoader.load(this.files[0]);\r\n            // reset so that the user can upload the same file again if they want to\r\n            this.value = '';\r\n        }, false);\r\n\r\n        L.DomEvent.disableClickPropagation(link);\r\n        L.DomEvent.on(link, 'click', function (e) {\r\n            fileInput.click();\r\n            e.preventDefault();\r\n        });\r\n        return container;\r\n    }\r\n});\r\n\r\nL.Control.fileLayerLoad = function (options) {\r\n    return new L.Control.FileLayerLoad(options);\r\n};\r\n\r\n\r\n\r\n\r\n"]}